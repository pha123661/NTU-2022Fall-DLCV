Loaded backbone from P2_ckpt/833_backbone.pth
Freezed backbone
Enable AMP training using dtype=torch.float16 on cuda
## Training args: {
  "train_image_dir": "hw4_data/office/train",
  "train_label": "hw4_data/office/train.csv",
  "val_image_dir": "hw4_data/office/val",
  "val_label": "hw4_data/office/val.csv",
  "device": "cuda",
  "backbone": "P2_ckpt/833_backbone.pth",
  "tb_dir": "P2_tb/finetune/E2",
  "ckpt_dir": "P2_ckpt/E2",
  "exp_name": "E2",
  "fp16": "True",
  "bf16": "False",
  "freeze_backbone": "True",
  "epochs": "300",
  "lr": "0.0005",
  "batch_size": "64",
  "warmup_steps": "100",
  "n_layers": "4",
  "dropout": "0.1",
  "hidden_size": "256"
}
epoch 0: va acc = 0.057883523404598236
## Saved model
epoch 1: va acc = 0.09144176170229912
## Saved model
epoch 2: va acc = 0.15713778510689735
## Saved model
epoch 3: va acc = 0.17240767180919647
## Saved model
epoch 4: va acc = 0.16690341010689735
epoch 5: va acc = 0.1993963085114956
## Saved model
epoch 6: va acc = 0.2205255702137947
## Saved model
epoch 7: va acc = 0.2381036952137947
## Saved model
epoch 8: va acc = 0.19424716010689735
epoch 9: va acc = 0.2439630702137947
## Saved model
epoch 10: va acc = 0.2381036952137947
epoch 11: va acc = 0.2521306835114956
## Saved model
epoch 12: va acc = 0.2420099452137947
epoch 13: va acc = 0.2478693202137947
epoch 14: va acc = 0.2791193202137947
## Saved model
epoch 15: va acc = 0.2540838085114956
epoch 16: va acc = 0.26313920319080353
epoch 17: va acc = 0.2501775585114956
epoch 18: va acc = 0.2752130702137947
epoch 19: va acc = 0.27876420319080353
epoch 20: va acc = 0.2771661952137947
epoch 21: va acc = 0.2697088085114956
epoch 22: va acc = 0.29243607819080353
## Saved model
epoch 23: va acc = 0.29048295319080353
epoch 24: va acc = 0.2713068202137947
epoch 25: va acc = 0.28657670319080353
epoch 26: va acc = 0.31551846861839294
## Saved model
epoch 27: va acc = 0.27485795319080353
epoch 28: va acc = 0.28462357819080353
epoch 29: va acc = 0.2872869335114956
epoch 30: va acc = 0.2908380702137947
epoch 31: va acc = 0.31747159361839294
## Saved model
epoch 32: va acc = 0.30184659361839294
epoch 33: va acc = 0.31551846861839294
epoch 34: va acc = 0.29438920319080353
epoch 35: va acc = 0.2970525585114956
epoch 36: va acc = 0.32954545319080353
## Saved model
epoch 37: va acc = 0.33274148404598236
## Saved model
epoch 38: va acc = 0.3025568202137947
epoch 39: va acc = 0.29243607819080353
epoch 40: va acc = 0.2814275585114956
epoch 41: va acc = 0.2853338085114956
epoch 42: va acc = 0.31392045319080353
epoch 43: va acc = 0.30415482819080353
epoch 44: va acc = 0.2986505702137947
epoch 45: va acc = 0.35227273404598236
## Saved model
epoch 46: va acc = 0.34446023404598236
epoch 47: va acc = 0.32333096861839294
epoch 48: va acc = 0.33664773404598236
epoch 49: va acc = 0.3142755702137947
epoch 50: va acc = 0.32563920319080353
epoch 51: va acc = 0.32368607819080353
epoch 52: va acc = 0.33345170319080353
epoch 53: va acc = 0.3103693202137947
epoch 54: va acc = 0.34090909361839294
epoch 55: va acc = 0.3084161952137947
epoch 56: va acc = 0.31977982819080353
epoch 57: va acc = 0.3142755702137947
epoch 58: va acc = 0.33895596861839294
epoch 59: va acc = 0.33504971861839294
epoch 60: va acc = 0.33469460904598236
epoch 61: va acc = 0.33309659361839294
epoch 62: va acc = 0.3538707420229912
## Saved model
epoch 63: va acc = 0.35813210904598236
## Saved model
epoch 64: va acc = 0.3499644920229912
epoch 65: va acc = 0.34250710904598236
epoch 66: va acc = 0.3636363670229912
## Saved model
epoch 67: va acc = 0.33700284361839294
epoch 68: va acc = 0.32919034361839294
epoch 69: va acc = 0.33149857819080353
epoch 70: va acc = 0.33860085904598236
epoch 71: va acc = 0.33931107819080353
epoch 72: va acc = 0.33895596861839294
epoch 73: va acc = 0.34481534361839294
epoch 74: va acc = 0.35067471861839294
epoch 75: va acc = 0.33149857819080353
epoch 76: va acc = 0.32368607819080353
epoch 77: va acc = 0.35813210904598236
epoch 78: va acc = 0.34446023404598236
epoch 79: va acc = 0.37109375
## Saved model
epoch 80: va acc = 0.3636363670229912
epoch 81: va acc = 0.35813210904598236
epoch 82: va acc = 0.36985085904598236
epoch 83: va acc = 0.34090909361839294
epoch 84: va acc = 0.34872159361839294
epoch 85: va acc = 0.36203835904598236
epoch 86: va acc = 0.33700284361839294
epoch 87: va acc = 0.35031960904598236
epoch 88: va acc = 0.33540482819080353
epoch 89: va acc = 0.34676846861839294
epoch 90: va acc = 0.3734019920229912
## Saved model
epoch 91: va acc = 0.34446023404598236
epoch 92: va acc = 0.376953125
## Saved model
epoch 93: va acc = 0.37180398404598236
epoch 94: va acc = 0.36594460904598236
epoch 95: va acc = 0.35813210904598236
epoch 96: va acc = 0.36239346861839294
epoch 97: va acc = 0.35493607819080353
epoch 98: va acc = 0.35617898404598236
epoch 99: va acc = 0.3753551170229912
epoch 100: va acc = 0.35848721861839294
epoch 101: va acc = 0.400390625
## Saved model
epoch 102: va acc = 0.36594460904598236
epoch 103: va acc = 0.35813210904598236
epoch 104: va acc = 0.36203835904598236
epoch 105: va acc = 0.3259943202137947
epoch 106: va acc = 0.37215909361839294
epoch 107: va acc = 0.36044034361839294
epoch 108: va acc = 0.34286221861839294
epoch 109: va acc = 0.33931107819080353
epoch 110: va acc = 0.3851207420229912
epoch 111: va acc = 0.33895596861839294
epoch 112: va acc = 0.36399148404598236
epoch 113: va acc = 0.37180398404598236
epoch 114: va acc = 0.38156960904598236
epoch 115: va acc = 0.36825284361839294
epoch 116: va acc = 0.37961648404598236
epoch 117: va acc = 0.34872159361839294
epoch 118: va acc = 0.3636363670229912
epoch 119: va acc = 0.3831676170229912
epoch 120: va acc = 0.36434659361839294
epoch 121: va acc = 0.37766335904598236
epoch 122: va acc = 0.36044034361839294
epoch 123: va acc = 0.37961648404598236
epoch 124: va acc = 0.38156960904598236
epoch 125: va acc = 0.36434659361839294
epoch 126: va acc = 0.35813210904598236
epoch 127: va acc = 0.35617898404598236
epoch 128: va acc = 0.36239346861839294
epoch 129: va acc = 0.36789773404598236
epoch 130: va acc = 0.35262784361839294
epoch 131: va acc = 0.38352273404598236
epoch 132: va acc = 0.36825284361839294
epoch 133: va acc = 0.36008523404598236
epoch 134: va acc = 0.3929332420229912
epoch 135: va acc = 0.35813210904598236
epoch 136: va acc = 0.3870738670229912
epoch 137: va acc = 0.3753551170229912
epoch 138: va acc = 0.37180398404598236
epoch 139: va acc = 0.37961648404598236
epoch 140: va acc = 0.38938210904598236
epoch 141: va acc = 0.38352273404598236
epoch 142: va acc = 0.37180398404598236
epoch 143: va acc = 0.35688920319080353
epoch 144: va acc = 0.3851207420229912
epoch 145: va acc = 0.36985085904598236
epoch 146: va acc = 0.36434659361839294
epoch 147: va acc = 0.36239346861839294
epoch 148: va acc = 0.37997159361839294
epoch 149: va acc = 0.35031960904598236
epoch 150: va acc = 0.36239346861839294
epoch 151: va acc = 0.36594460904598236
epoch 152: va acc = 0.3909801170229912
epoch 153: va acc = 0.37375710904598236
epoch 154: va acc = 0.37766335904598236
epoch 155: va acc = 0.38742898404598236
epoch 156: va acc = 0.37375710904598236
epoch 157: va acc = 0.3714488670229912
epoch 158: va acc = 0.36079545319080353
epoch 159: va acc = 0.37215909361839294
epoch 160: va acc = 0.38938210904598236
epoch 161: va acc = 0.37961648404598236
epoch 162: va acc = 0.36594460904598236
epoch 163: va acc = 0.37411221861839294
epoch 164: va acc = 0.37375710904598236
epoch 165: va acc = 0.37606534361839294
epoch 166: va acc = 0.37571023404598236
epoch 167: va acc = 0.37606534361839294
epoch 168: va acc = 0.3987926170229912
epoch 169: va acc = 0.3987926170229912
epoch 170: va acc = 0.37961648404598236
epoch 171: va acc = 0.37997159361839294
epoch 172: va acc = 0.36239346861839294
epoch 173: va acc = 0.3773082420229912
epoch 174: va acc = 0.37571023404598236
epoch 175: va acc = 0.36629971861839294
epoch 176: va acc = 0.36434659361839294
epoch 177: va acc = 0.36985085904598236
epoch 178: va acc = 0.36594460904598236
epoch 179: va acc = 0.37571023404598236
epoch 180: va acc = 0.37020596861839294
epoch 181: va acc = 0.37020596861839294
epoch 182: va acc = 0.37180398404598236
epoch 183: va acc = 0.37766335904598236
epoch 184: va acc = 0.37180398404598236
epoch 185: va acc = 0.37375710904598236
epoch 186: va acc = 0.36079545319080353
epoch 187: va acc = 0.37215909361839294
epoch 188: va acc = 0.36825284361839294
epoch 189: va acc = 0.37766335904598236
epoch 190: va acc = 0.36825284361839294
epoch 191: va acc = 0.36239346861839294
epoch 192: va acc = 0.36629971861839294
epoch 193: va acc = 0.36985085904598236
epoch 194: va acc = 0.37961648404598236
epoch 195: va acc = 0.36079545319080353
epoch 196: va acc = 0.36434659361839294
epoch 197: va acc = 0.36825284361839294
epoch 198: va acc = 0.37020596861839294
epoch 199: va acc = 0.37997159361839294
epoch 200: va acc = 0.37801846861839294
epoch 201: va acc = 0.38938210904598236
epoch 202: va acc = 0.37606534361839294
epoch 203: va acc = 0.38938210904598236
epoch 204: va acc = 0.37961648404598236
epoch 205: va acc = 0.37961648404598236
epoch 206: va acc = 0.38352273404598236
epoch 207: va acc = 0.38352273404598236
epoch 208: va acc = 0.37411221861839294
epoch 209: va acc = 0.38352273404598236
epoch 210: va acc = 0.37020596861839294
epoch 211: va acc = 0.38583096861839294
epoch 212: va acc = 0.37411221861839294
epoch 213: va acc = 0.38192471861839294
epoch 214: va acc = 0.39133523404598236
epoch 215: va acc = 0.3909801170229912
epoch 216: va acc = 0.3948863670229912
epoch 217: va acc = 0.38938210904598236
epoch 218: va acc = 0.39133523404598236
epoch 219: va acc = 0.39328835904598236
epoch 220: va acc = 0.4026988670229912
## Saved model
epoch 221: va acc = 0.3987926170229912
epoch 222: va acc = 0.38192471861839294
epoch 223: va acc = 0.38352273404598236
epoch 224: va acc = 0.39328835904598236
epoch 225: va acc = 0.4066051170229912
## Saved model
epoch 226: va acc = 0.38938210904598236
epoch 227: va acc = 0.39328835904598236
epoch 228: va acc = 0.38547585904598236
epoch 229: va acc = 0.39914773404598236
epoch 230: va acc = 0.4105113670229912
## Saved model
epoch 231: va acc = 0.39328835904598236
epoch 232: va acc = 0.39133523404598236
epoch 233: va acc = 0.38156960904598236
epoch 234: va acc = 0.4046519920229912
epoch 235: va acc = 0.39328835904598236
epoch 236: va acc = 0.4046519920229912
epoch 237: va acc = 0.3929332420229912
epoch 238: va acc = 0.39133523404598236
epoch 239: va acc = 0.4026988670229912
epoch 240: va acc = 0.3968394920229912
epoch 241: va acc = 0.37997159361839294
epoch 242: va acc = 0.37606534361839294
epoch 243: va acc = 0.38387784361839294
epoch 244: va acc = 0.37997159361839294
epoch 245: va acc = 0.37801846861839294
epoch 246: va acc = 0.37997159361839294
epoch 247: va acc = 0.39524148404598236
epoch 248: va acc = 0.37606534361839294
epoch 249: va acc = 0.38742898404598236
epoch 250: va acc = 0.37411221861839294
epoch 251: va acc = 0.38938210904598236
epoch 252: va acc = 0.38547585904598236
epoch 253: va acc = 0.39133523404598236
epoch 254: va acc = 0.37801846861839294
epoch 255: va acc = 0.38352273404598236
epoch 256: va acc = 0.37801846861839294
epoch 257: va acc = 0.38742898404598236
epoch 258: va acc = 0.37801846861839294
epoch 259: va acc = 0.38192471861839294
epoch 260: va acc = 0.39328835904598236
epoch 261: va acc = 0.38192471861839294
epoch 262: va acc = 0.38192471861839294
epoch 263: va acc = 0.37801846861839294
epoch 264: va acc = 0.37997159361839294
epoch 265: va acc = 0.38192471861839294
epoch 266: va acc = 0.39328835904598236
epoch 267: va acc = 0.39133523404598236
epoch 268: va acc = 0.37411221861839294
epoch 269: va acc = 0.37961648404598236
epoch 270: va acc = 0.37801846861839294
epoch 271: va acc = 0.4007457420229912
epoch 272: va acc = 0.37801846861839294
epoch 273: va acc = 0.38742898404598236
epoch 274: va acc = 0.38547585904598236
epoch 275: va acc = 0.37801846861839294
epoch 276: va acc = 0.37801846861839294
epoch 277: va acc = 0.38192471861839294
epoch 278: va acc = 0.38742898404598236
epoch 279: va acc = 0.38547585904598236
epoch 280: va acc = 0.38192471861839294
epoch 281: va acc = 0.37997159361839294
epoch 282: va acc = 0.37606534361839294
epoch 283: va acc = 0.37020596861839294
epoch 284: va acc = 0.39719460904598236
epoch 285: va acc = 0.39524148404598236
epoch 286: va acc = 0.38192471861839294
epoch 287: va acc = 0.38192471861839294
epoch 288: va acc = 0.38387784361839294
epoch 289: va acc = 0.37801846861839294
epoch 290: va acc = 0.38973721861839294
epoch 291: va acc = 0.38192471861839294
epoch 292: va acc = 0.38778409361839294
epoch 293: va acc = 0.38973721861839294
epoch 294: va acc = 0.38192471861839294
epoch 295: va acc = 0.37801846861839294
epoch 296: va acc = 0.37801846861839294
epoch 297: va acc = 0.39524148404598236
epoch 298: va acc = 0.38583096861839294
epoch 299: va acc = 0.39133523404598236
## Training args: {
  "train_image_dir": "hw4_data/office/train",
  "train_label": "hw4_data/office/train.csv",
  "val_image_dir": "hw4_data/office/val",
  "val_label": "hw4_data/office/val.csv",
  "device": "cuda",
  "backbone": "P2_ckpt/833_backbone.pth",
  "tb_dir": "P2_tb/finetune/E2",
  "ckpt_dir": "P2_ckpt/E2",
  "exp_name": "E2",
  "fp16": "True",
  "bf16": "False",
  "freeze_backbone": "True",
  "epochs": "300",
  "lr": "0.0005",
  "batch_size": "64",
  "warmup_steps": "100",
  "n_layers": "4",
  "dropout": "0.1",
  "hidden_size": "256"
}
## Final Result, va acc = 0.4105113670229912
