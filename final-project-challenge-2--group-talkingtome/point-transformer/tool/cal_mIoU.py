import numpy as np
import sys


# CLASS_FREQUENCY_200 = {
#     0: 28846556,
#     1: 5724064,
#     2: 22601567,
#     3: 2878057,
#     4: 3743637,
#     5: 2354252,
#     6: 2494992,
#     7: 2416439,
#     8: 1855083,
#     9: 885442,
#     10: 2379144,
#     11: 371431,
#     12: 255033,
#     13: 454972,
#     14: 3693457,
#     15: 293829,
#     16: 2382845,
#     17: 570621,
#     18: 1847184,
#     19: 831180,
#     20: 782322,
#     21: 491049,
#     22: 329867,
#     23: 489067,
#     24: 212621,
#     25: 1156595,
#     26: 185048,
#     27: 390416,
#     28: 332033,
#     29: 304057,
#     30: 192769,
#     31: 420522,
#     32: 193359,
#     33: 33917,
#     34: 539192,
#     35: 2688553,
#     36: 293670,
#     37: 101933,
#     38: 93102,
#     39: 36695,
#     40: 89834,
#     41: 245390,
#     42: 28666,
#     43: 108751,
#     44: 188438,
#     45: 801887,
#     46: 120508,
#     47: 298524,
#     48: 808913,
#     49: 266098,
#     50: 167056,
#     51: 103662,
#     52: 219198,
#     53: 50764,
#     54: 110835,
#     55: 27727,
#     56: 15928,
#     57: 119831,
#     58: 102638,
#     59: 142292,
#     60: 94904,
#     61: 215020,
#     62: 236779,
#     63: 20850,
#     64: 214119,
#     65: 186019,
#     66: 60011,
#     67: 36882,
#     68: 249424,
#     69: 25625,
#     70: 69709,
#     71: 75909,
#     72: 24140,
#     73: 167893,
#     74: 28722,
#     75: 4982,
#     76: 252783,
#     77: 56176,
#     78: 94783,
#     79: 15568,
#     80: 426593,
#     81: 145991,
#     82: 23633,
#     83: 233672,
#     84: 13717,
#     85: 21938,
#     86: 16288,
#     87: 9032,
#     88: 34767,
#     89: 43634,
#     90: 39415,
#     91: 27486,
#     92: 60399,
#     93: 16396,
#     94: 4046,
#     95: 41277,
#     96: 7688,
#     97: 65246,
#     98: 16029,
#     99: 50261,
#     100: 347580,
#     101: 456751,
#     102: 16242,
#     103: 71402,
#     104: 21465,
#     105: 39067,
#     106: 28624,
#     107: 7892,
#     108: 27553,
#     109: 18883,
#     110: 81615,
#     111: 11916,
#     112: 2211,
#     113: 67982,
#     114: 7744,
#     115: 60486,
#     116: 3952,
#     117: 262915,
#     118: 678150,
#     119: 15127,
#     120: 112891,
#     121: 5943,
#     122: 18444,
#     123: 4194,
#     124: 5879,
#     125: 32081,
#     126: 10535,
#     127: 14343,
#     128: 22023,
#     129: 74124,
#     130: 27912,
#     131: 6191,
#     132: 6925,
#     133: 6739,
#     134: 41267,
#     135: 72398,
#     136: 19980,
#     137: 3396,
#     138: 10421,
#     139: 1778,
#     140: 11230,
#     141: 779,
#     142: 49136,
#     143: 9393,
#     144: 4084,
#     145: 124223,
#     146: 12117,
#     147: 3647,
#     148: 3583,
#     149: 7237,
#     150: 1523,
#     151: 23900,
#     152: 5286,
#     153: 17758,
#     154: 29925,
#     155: 5069,
#     156: 1110,
#     157: 4217,
#     158: 5875,
#     159: 5981,
#     160: 8645,
#     161: 4629,
#     162: 4013,
#     163: 204267,
#     164: 4135,
#     165: 13550,
#     166: 1395,
#     167: 11331,
#     168: 52581,
#     169: 17766,
#     170: 5216,
#     171: 47046,
#     172: 419060,
#     173: 217800,
#     174: 113729,
#     175: 29127,
#     176: 91576,
#     177: 26083,
#     178: 37204,
#     179: 6413,
#     180: 80652,
#     181: 13590,
#     182: 109472,
#     183: 5681,
#     184: 12696,
#     185: 3096,
#     186: 49187,
#     187: 1047,
#     188: 2281,
#     189: 8933,
#     190: 1696,
#     191: 24775,
#     192: 19246,
#     193: 1309,
#     194: 1056,
#     195: 4318,
#     196: 20836,
#     197: 18830,
#     198: 7661,
#     199: 24867,
#     # 255: 14396631
# }

# sorted_idx = [k for k, v in sorted(CLASS_FREQUENCY_200.items(), key=lambda x: x[1], reverse=True)]
# print(sorted_idx)
sorted_idx = [0, 2, 1, 4, 14, 3, 35, 6, 7, 16, 10, 5, 8, 18, 25, 9, 19, 48, 45, 20, 118, 17, 34, 21, 23, 101, 13, 80, 31, 172, 27, 11, 100, 28, 22, 29, 47, 15, 36, 49, 117, 12, 76, 68, 41, 62, 83, 52, 173, 61, 64, 24, 163, 32, 30, 44, 65, 26, 73, 50, 81, 59, 145, 46, 57, 174, 120, 54, 182, 43, 51, 58, 37, 60, 78, 38, 176, 40, 110, 180, 71, 129, 135, 103, 70, 113, 97, 115, 92, 66, 77, 168, 53, 99, 186, 142, 171, 89, 95, 134, 90, 105, 178, 67, 39, 88, 33, 125, 154, 175, 74, 42, 106, 130, 55, 108, 91, 177, 69, 199, 191, 72, 151, 82, 128, 85, 104, 63, 196, 136, 192, 109, 197, 122, 169, 153, 93, 86, 102, 98, 56, 79, 119, 127, 84, 181, 165, 184, 146, 111, 167, 140, 126, 138, 143, 87, 189, 160, 107, 114, 96, 198, 149, 132, 133, 179, 131, 159, 121, 124, 158, 183, 152, 170, 155, 75, 161, 195, 157, 123, 164, 144, 94, 162, 116, 147, 148, 137, 185, 188, 112, 139, 190, 150, 166, 193, 156, 194, 187, 141]

f = open(sys.argv[1], 'r')
file = f.read()
iou_score = file.splitlines()[-1][5:]
tmp = iou_score.split(", ")
iou_score_list = [float(item) for item in tmp]

# print(iou_score_list)
f.close()

head_iou = iou_score_list[:66]
common_iou = iou_score_list[66:-66]
tail_iou = iou_score_list[-66:]

print(np.mean(head_iou))
print(np.mean(common_iou))
print(np.mean(tail_iou))

# iou_class = intersection_meter.sum / (union_meter.sum + 1e-10)

# sns.set(rc={'figure.figsize': (15, 7.5)})
# sns.set_context('paper')
# ax = sns.barplot(x=np.arange(200), y=-iou_class)
# ax.set(title="Per-Class IoU", xticklabels=[])
# ax.tick_params(bottom=False)
# sns.despine(ax=ax)
# ax.get_figure().savefig('per_class_IoU_trans', dpi=800, transparent=True)

# sns.set_style(style="darkgrid")
# ax.get_figure().savefig('per_class_IoU_white', dpi=800,)